#!/usr/bin/env node

var program = require('commander');
var pkg = require('../package');
var Runner = require('..');
var cli = require('../lib/cli');
var browsers = require('./browsers');
var co = require('co');

/**
 * Program
 */

program
  .version(pkg.version)
  .usage('<cmd> [options]')
  .option('-p, --path <path>', 'tests path defaulted to "/test"', '/test')

/**
 * Test <browser>
 */

browsers.forEach(function(name){
  program
  .command(name)
  .description('run tests using ' + name)
  .action(cli.browser(program, name));
});

/**
 * Test phantom
 */

program
  .command('phantomjs')
  .description('run tests using phantom')
  .action(cli.phantomjs(program));

/**
 * Create tests.
 */

program
  .command('phantomjs')
  .description('create test/ directory')
  .option('-t, --title <title>', 'set index.html title, defaulted to component.json "name"')
  .option('-b, --build <path>', 'set the build path, defaulted to test/build.js', 'test/build.js')
  .action(cli.create(program));

/**
 * Parse
 */

program.parse(process.argv);

/**
 * !command test in phantomjs
 */

if (!program.args.length) {
  cli.phantomjs(program)();
}
